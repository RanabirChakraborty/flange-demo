---
- assert:
    that:
      - wildfly is defined
      - wildfly.config is defined
      - wildfly.config.name is defined
      - wildfly.basedir_prefix is defined
      - wildfly.home is defined
      - nb_instance_by_node is defined
    quiet: true

- name: 'Stop all Wildfly instances'
  service:
    name: "{{ wildfly.config.name }}-{{ item }}"
    state: stopped
  loop: "{{ range(1, (nb_instances|int + 1)) | list }}"

- name: "Delete all runtimes data"
  file:
    state: absent
    path: "{{ wildfly.basedir_prefix }}{{ item }}"
  loop: "{{ range(1, (nb_instances|int + 1)) | list }}"

- name: "Uninstall Wildfly binaries"
  file:
    state: absent
    path: "{{ wildfly.home }}"
